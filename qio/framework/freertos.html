<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>freeRTOS &mdash; OS-Q</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://www.os-q.com/qio/framework/freertos.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RT-Thread" href="rtthread.html" />
    <link rel="prev" title="Zephyr" href="zephyr.html" />
 
<link rel="stylesheet" href="../_static/css/extra.css" type="text/css" />
<script src="../_static/js/bootstrap.min.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> QIO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">

              <ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">开源协议</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">版本迭代</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">核心资源</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../template/index.html">工程模板</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/index.html">辅助设施</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">关联组件</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">流行框架</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#frameworks-sdk">软件框架</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#frameworks-rtos">实时系统</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#kernel">内核(Kernel)</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#id6">时间片轮番调度</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#id7">任务优先级</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="zephyr.html">Zephyr</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">freeRTOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="rtthread.html">RT-Thread</a></li>
<li class="toctree-l4"><a class="reference internal" href="harmonyos.html">HarmonyOS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#frameworks-gui">图形框架</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../standard/index.html">行业标准</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">生态接入</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/coder.html">代码编辑</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/kicad.html">硬件设计</a></li>
</ul>

<ins data-rvad-zoneid="7" data-rvad-id="f837d8c96893e793fdbb230cffb628fc"></ins>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QIO</a>
      </nav>

      <div class="wy-nav-content">
<ins data-rvad-zoneid="1" data-rvad-id="f837d8c96893e793fdbb230cffb628fc"></ins>

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">开发框架</a></li>
      <li class="breadcrumb-item active">freeRTOS</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/OS-Q/docs/blob/qio/source/framework/freertos.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="freertos">
<span id="frameworks-freertos"></span><h1>freeRTOS<a class="headerlink" href="#freertos" title="Permalink to this heading">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>父类</p></th>
<th class="head"><p>证书</p></th>
<th class="head"><p>知识</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#frameworks-rtos"><span class="std std-ref">实时系统</span></a></p></td>
<td><p><a class="reference internal" href="../license.html#license-mit"><span class="std std-ref">MIT</span></a></p></td>
<td><p><a class="reference external" href="https://docs.qitas.cn/system/rtos.html">RTOS</a></p></td>
</tr>
</tbody>
</table>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id24">系统简介</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id25">系统特点</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id26">系统状态</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id27">任务调度</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id28">任务间通讯</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id29">源文件解读</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id30">问题总结</a></p></li>
<li><p><a class="reference internal" href="#id21" id="id31">RTOS对比</a></p></li>
</ul>
</div>
<section id="id1">
<h2><a class="toc-backref" href="#id24">系统简介</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.freertos.org/">FreeRTOS</a> 是采用一款适用于微控制器的开源实时操作系统，让您可以轻松地编写、部署、保护、连接和管理低功耗的小型边缘设备。</p>
<p>FreeRTOS 在 MIT 开源许可证下免费分发，包括一个内核和一组不断丰富的软件库，适用于各种行业部门和应用程序。</p>
<p>许多半导体厂商产品的 SDK(Software Development Kit—软件开发工具包) 包就使用 FreeRTOS 作为其操作系统，尤其是WiFi、BLE这些带协议栈的芯片或模块。</p>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id25">系统特点</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>FreeRTOS 是一个可裁剪的小型 RTOS 系统，其特点包括：</p>
<ul class="simple">
<li><p>内核支持抢占式，合作式和时间片调度。</p></li>
<li><p>提供了一个用于低功耗的 Tickless 模式。</p></li>
<li><p>系统的组件在创建时可以选择动态或者静态的 RAM，比如任务、消息队列、信号量、软件定时器等等。</p></li>
<li><p>FreeRTOS-MPU 支持 Corex-M 系列中的 MPU 单元，如 STM32F429。</p></li>
<li><p>FreeRTOS 系统简单、小巧、易用，通常情况下内核占用 4k-9k 字节的空间。</p></li>
<li><p>高可移植性，代码主要 C 语言编写。</p></li>
<li><p>高效的软件定时器。</p></li>
<li><p>强大的跟踪执行功能。</p></li>
<li><p>堆栈溢出检测功能。</p></li>
<li><p>任务数量不限。</p></li>
<li><p>任务优先级不限。</p></li>
</ul>
</section>
<section id="id4">
<h2><a class="toc-backref" href="#id26">系统状态</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>FreeRTOS中的任务一共有四种状态分别是运行状态（Running State），就绪状态（Ready State），阻塞状态（Blocked State），挂起状态（Suspended State）</p>
<p>TCB_t的全称为Task Control Block，也就是任务控制块，这个结构体包含了一个任务所有的信息</p>
</section>
<section id="id5">
<h2><a class="toc-backref" href="#id27">任务调度</a><a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<p>FreeRTOS对任务的调度采用时间片（time slicing）的调度方式。时间片，顾名思义，把一段时间等分成了很多个时间段，在每一个时间段保证优先级最高的任务能执行，同时如果几个任务拥有相等的优先级，则它们会轮流使用每个时间段占用CPU资源。调度器会在每个时间片结束的时候通过周期中断（tick interrupt）执行一次，选择哪个任务在下一个时间片会运行。</p>
<p>时间片的大小由configTICK_RATE_HZ这个参数设置。如果configTICK_RATE_HZ设置为10HZ，则时间片的大小为100ms。configTICK_RATE_HZ的值由应用需求决定，通常设为100HZ（时间片大小相应为10ms）。</p>
<p>vTaskList( char * pcWriteBuffer ) 这个函数可以打印出栈名、栈状态、优先级、栈的剩余空间，使用该功能FreeRTOSconfig.h要配置：</p>
<ul class="simple">
<li><p>configUSE_TRACE_FACILITY 1</p></li>
<li><p>configUSE_STATS_FORMATTING_FUNCTIONS 1</p></li>
</ul>
<p>任务调度机制是嵌入式实时操作系统的一个重要概念，也是其核心技术。对于可剥夺型内核，优先级高的任务一旦就绪就能剥夺优先级较低任务的CPU使用权，提高了系统的实时响应能力。不同于μC/OS-II，FreeRTOS对系统任务的数量没有限制，既支持优先级调度算法也支持轮换调度算法，因此FreeRTOS采用双向链表而不是采用查任务就绪表的方法来进行任务调度。</p>
<p>具有固定优先级调度程序的RTOS的核心思想是，应该在具有较低优先级的任务之前安排高优先级任务，但是当两个或多个任务需要协调其工作与全局数据区等共享资源或外围设备时，可能会导致系统出错。</p>
<p>其中一个可能出错的事情就是优先级反转(priorityinversion)，低优先级任务无意中阻止了具有更高优先级的任务。 如果你意识到这个陷阱，这也很容易地避免。但是，如果发现系统的响应性偶尔会出现延迟，则可能是因为优先级反转。使用Tracealyzer，可以通过绘制任务的响应时间来发现此类延迟。要查看此图中任何极端值的原因，只需双击以显示相应的任务执行跟踪。</p>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id28">任务间通讯</a><a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<p>任务通讯的几种方式：queue，semaphores mutexes和event groups。</p>
<p>其中semaphores mutexes都是基于队列的方式实现，notify机制和event groups最为类似，但是实现方式有较大差异。Notify机制是在每个任务中添加一个32位无符号字符标记，其他任务对该任务的通知。</p>
<div class="contents local topic" id="id7">
<ul class="simple">
<li><p><a class="reference internal" href="#id8" id="id32">信号量</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id33">二值型信号量</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id34">互斥型信号量</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id35">递归互斥信号量</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="id8">
<h3><a class="toc-backref" href="#id32">信号量</a><a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p>信号量通过一个计数器控制对共享资源的访问，信号量的值是一个非负整数，所有通过它的线程都会将该整数减一。如果计数器大于0，则访问被允许，计数器减1；如果为0，则访问被禁止，所有试图通过它的线程都将处于等待状态。</p>
<ul class="simple">
<li><p>整型信号量（integer semaphore)：信号量取值是整数，它可以被多个线程同时获得，直到信号量的值变为0。</p></li>
<li><p>记录型信号量（record semaphore)：每个信号量s除一个整数值value（计数）外，还有一个等待队列List，其中是阻塞在该信号量的各个线程的标识。当信号量被释放一个，值被加一后，系统自动从等待队列中唤醒一个等待中的线程，让其获得信号量，同时信号量再减一。</p></li>
<li><p>二进制信号量(binary semaphore)：只允许信号量取0或1值，其同时只能被一个线程获取。</p></li>
</ul>
<section id="id9">
<h4><a class="toc-backref" href="#id33">二值型信号量</a><a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h4>
<p>二值信号量相当于长度为1的队列，那么计数型信号量就是长度大于1的队列，同二值信号量一样，用户不需要关心队列中存储了什么数据，只需要关心队列是否为空即可。</p>
<p>二值型信号量是任务间、任务与中断间同步的重要手段。</p>
<ul class="simple">
<li><p>1、没有优先级继承</p></li>
<li><p>2、可以在中断中使用</p></li>
<li><p>3、可以在其他任务释放</p></li>
</ul>
</section>
<section id="id10">
<h4><a class="toc-backref" href="#id34">互斥型信号量</a><a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h4>
<p>互斥型信号量是任务间资源保护的重要手段。</p>
<p>申明互斥型信号量，在FreeRTOS中二值型信号量和互斥型信号量类型完全相同。从功能上二值型信号量用于同步，而互斥型信号量用于资源保护。</p>
<p>不同于二值信号量的是互斥信号量具有优先级继承的特性，可以有效解决优先级反转现象。当一个互斥信号量正在被一个低优先级的任务使用，而此时有个高优先级的任务也尝试获取这个互斥信号量的话就会被阻塞。不过这个高优先级的任务会被低优先级任务的优先级提升到与自己相同的优先级，这个过程就是优先级传承。</p>
<ul class="simple">
<li><p>1、优先级继承</p></li>
<li><p>2、互斥量不能在中断中使用</p></li>
<li><p>3、互斥量获取和释放需要再同一个task中</p></li>
</ul>
</section>
<section id="id11">
<h4><a class="toc-backref" href="#id35">递归互斥信号量</a><a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h4>
<p>递归互斥信号量可以看做一个特殊的互斥信号量，已经获取了互斥信号量的任务就不能再次获取这个互斥信号量，但是递归互斥信号量不同，已经获取了递归互斥信号量的任务可以再次获取这个递归互斥信号量，而且次数不限制。并且获取多少次信号量，就需要释放多少次信号量。</p>
</section>
</section>
</section>
<section id="id12">
<h2><a class="toc-backref" href="#id29">源文件解读</a><a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h2>
<div class="contents local topic" id="id13">
<ul class="simple">
<li><p><a class="reference internal" href="#id14" id="id36">FreeRTOS</a></p></li>
<li><p><a class="reference internal" href="#freertos-plus" id="id37">FreeRTOS-Plus</a></p></li>
</ul>
</div>
<section id="id14">
<h3><a class="toc-backref" href="#id36">FreeRTOS</a><a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h3>
<p>Demo 文件夹里面就是 FreeRTOS 针对不同的 MCU 提供的相关例程，其中就有 ST 的 F1、F4 和F7 的相关例程。</p>
<p>License 文件夹里面就是 相关的许可信息，要用 FreeRTOS 做产品的得仔细看看，尤其是要出口的产品。</p>
<p>Source 文件夹里面就是 FreeRTOS 的源码文件，include 文件夹是一些头文件，移植的时候是需要的，下面的这些.C 文件就是 FreeRTOS 的源码文件。</p>
<p>portable 文件夹里面就是FreeRTOS系统和具体的硬件之间的连接桥梁！MemMang 这个文件夹是跟内存管理相关的，我们移植的时候是必须的。</p>
<p>RVDS 文件夹针对不同的架构的 MCU 做了详细的分类，STM32F429 就参考 ARM_CM4F，打开 ARM_CM4F 文件夹，里面有两个文件，这两个文件就是我们移植的时候所需要的！</p>
</section>
<section id="freertos-plus">
<h3><a class="toc-backref" href="#id37">FreeRTOS-Plus</a><a class="headerlink" href="#freertos-plus" title="Permalink to this heading">¶</a></h3>
<p>里面也有 Demo 和 Source，Demo 文件夹里存放的肯定是一些例程， 而Source文件夹中存放的并不是 FreeRTOS 系统的源码，是在这个 FreeRTOS系统上另外增加的一些功能代码，比如 CLI、FAT、Trace 等等。</p>
</section>
</section>
<section id="id15">
<h2><a class="toc-backref" href="#id30">问题总结</a><a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h2>
<div class="contents local topic" id="id16">
<ul class="simple">
<li><p><a class="reference internal" href="#id17" id="id38">优先级翻转</a></p>
<ul>
<li><p><a class="reference internal" href="#id18" id="id39">优先级继承</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id19" id="id40">死锁</a></p></li>
<li><p><a class="reference internal" href="#id20" id="id41">内存泄漏</a></p></li>
</ul>
</div>
<section id="id17">
<h3><a class="toc-backref" href="#id38">优先级翻转</a><a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h3>
<p>taskA的任务优先级高于taskB，但是由于taskA等待请求获取shareData资源，taskC持有shareData资源但被优先级高于它的taskB抢占阻塞，于是高优先级的taskA被挂起。</p>
<section id="id18">
<h4><a class="toc-backref" href="#id39">优先级继承</a><a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h4>
<p>在高优先级的taskA获取资源锁时，将taskC的优先级临时提高为taskA的优先级，那么上述案例中，taskB就无法打断taskC的执行，因此taskC执行完成释放资源锁后，taskA能及时的进入ready状态</p>
<p>优先级恢复流程相对比较简单，在taskC使用完，调用释放接口的时候，会执行优先级恢复，此时taskC继续恢复其低优先级。</p>
<p>信号量一般是用于同步的，同步的场景上，需要保证优先级高的任务优先执行，做到真正的实时性，优先级继承会打破这个需求。</p>
</section>
</section>
<section id="id19">
<h3><a class="toc-backref" href="#id40">死锁</a><a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h3>
<p>死锁是两个或多个任务之间的循环依赖。</p>
<p>例如，如果任务1已经获得A，并且被阻止等待B，而任务2先前已获得B，并且被阻止等待A，则这两个任务都不会被唤醒。 尽管没有更高优先级的任务正在运行，但是当多个任务突然停止执行时，可能是出现死锁问题的明确迹象。 同样，死锁的检测是Tracealyzer可以展示的内容。</p>
<p>如果希望避免死锁，首先要注意的是，只有当任务试图同时持有两个资源时才会发生死锁。 因此：构建代码时，使任何任务在同一时间都不会持有多个共享资源，这样不会产生死锁。</p>
</section>
<section id="id20">
<h3><a class="toc-backref" href="#id41">内存泄漏</a><a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h3>
<p>通常不建议在嵌入式软件中进行动态内存分配，但有时会出于各种原因（对或错）进行动态内存分配。问题在于，如果使用它，则必须确保一旦内存块不再使用时，就释放每个已分配的内存块。如果在某些情况下遗漏了这一点，就会出现内存泄漏，并最终耗尽内存。请记住：即使在项目中禁止动态内存分配，也可能有第三方软件库或外部开发团队在不知情的情况下使用动态内存分配。</p>
<p>如果内存泄漏只是偶尔发生，那么它就特别危险，因为在功能测试期间很容易错过“缓慢”的内存泄漏，但在部署单元一段时间后，可能会导致严重错误。考虑到许多嵌入式系统的长期运行特性，以及一些安全关键系统可能存在的致命或严重故障，内存泄漏是绝对不希望在软件中出现的一个错误。</p>
<p>ARM对嵌入式操作系统进行了顶层设计，不同的操作系统要对他进行适配，这样更换操作系统就比较方便了，使用ARM提供的API编写的应用层程序，更换操作系统后是不需要修改的。</p>
</section>
</section>
<section id="id21">
<h2><a class="toc-backref" href="#id31">RTOS对比</a><a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h2>
<div class="contents local topic" id="id22">
<ul class="simple">
<li><p><a class="reference internal" href="#ucos-iii" id="id42">对比uCOS-III</a></p>
<ul>
<li><p><a class="reference internal" href="#id23" id="id43">相关问题</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="ucos-iii">
<h3><a class="toc-backref" href="#id42">对比uCOS-III</a><a class="headerlink" href="#ucos-iii" title="Permalink to this heading">¶</a></h3>
<p>从文件数量上来看 FreeRTOS 要比uC/OSII 和 uC/OSIII 小的多。</p>
<p>uCOS-III中所有的内核对象（如任务控制块、消息队列、信号量等）都是静态创建的，需要用户提供。FreeRTOS中的内核对象支持动态和静态两种创建方法。</p>
<p>为了实现中断和任务的同步，需要在中断中进行post操作，uC/OS-III为了减少中断执行的时间，提高系统中断响应的实时性，设计了OS_tickTask和OS_IntQTask，这样原本在中断里需要进行的一些较为耗时的操作就被放到了任务级代码中执行了。而FreeRTOS并没有这样的设计。</p>
<p>在FreeRTOS的PendSV中断中，它会计算就绪的最高优先级的任务，再去进行上下文切换。而uC/OS-III在触发PendSV中断前，会计算好已就绪的最高优先级的任务，放在OSTCBHighRdyPtr中，这样在PendSV中断中就不用计算就绪的最高优先级的任务是谁了。所以uC/OS-III中PendSV中断的执行时间更短，这有利于提高系统的实时性。</p>
<p>uCOS-III的任务操作句柄就是任务控制块TCB的指针。FreeRTOS中单独设置了任务操作句柄这种数据类型，它实质上也是TCB的指针。表面上看，多此一举，但其实这种设计对用户是友好的，用户不需要了解TCB这种内核数据结构的存在，就可以操作任务了。</p>
<p>uCOS-III内核中的链表大多是不循环的双向链表（有头有尾），在插入和删除操作时，要考虑特殊情况（比如插入表头、插入表尾等特殊情况）。</p>
<p>而FreeRTOS内核中的链表为双向循环链表，并引入了xListEnd保证了链表永远非空，所以每个元素的插入和删除都是作为表中的一般元素（非表头和表尾）进行的，操作效率要比uC/OS-III高一些。</p>
<p>FreeRTOS功能更丰富、更易用；uC/OS-III的实时性更好、效率更高、健壮性更好。</p>
<p>其实RTOS最主要的功能就是任务调度，其它功能都可以自己开发，难度不大。单独从任务调度器的角色出发去对比这两个RTOS，我觉得uC/OS-III更漂亮、更优秀。</p>
<p>uC/OS-III通过的安全认证比FreeRTOS要多，FreeRTOS的代码书写是不符合一些标准的。在FreeRTOS的基础上建立了另外两个RTOS：SafeRTOS、OpenRTOS，它们具有更好的安全性，通过了更多的检验和标准，但是与FreeRTOS不一样，需要收费。</p>
<section id="id23">
<h4><a class="toc-backref" href="#id43">相关问题</a><a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h4>
<p>μC/OS 2.86任务卡死在低优先级任务出不来，高优先级任务不执行，后来从Micrium下载μC/OS 2.91从里面what’s new.pdf里面查到对Cortex-M3有问题（中断优先级大小顺序问题），已修正，然后用高版本的果然没问题。</p>
<p>然后在下一个项目里面使用了FreeRTOS，感觉跟μC/OS差不多，只是任务栈消耗的稍大。我用的IAR，里面有μC/OS、FreeRTOS插件，可以在运行的时候看到任务栈历史最大使用和当前使用，以及CPU负载率等等很重要的信息。</p>
<p>NVIC_PriorityGroup_4 抢占优先级的要比“MAX”更大，而比“LOWEST”更小</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY</span><span class="o">=</span><span class="m">5</span>
<span class="nv">configLIBRARY_LOWEST_INTERRUPT_PRIORITY</span><span class="o">=</span><span class="m">15</span>
</pre></div>
</div>
<p>FreeRTOS中数值越大优先级越高，这种优先级可以成为逻辑优先级。Cortex M3/M4中断中，数值越大优先级越低，这种优先级成为中断优先级。两者相反，所以才会出现比”MAX”更大而比“LOWEST”更小的情况。</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="zephyr.html" class="btn btn-neutral float-left" title="Zephyr" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rtthread.html" class="btn btn-neutral float-right" title="RT-Thread" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">

    <p>&#169; Copyright 2021 - 2023 www.OS-Q.com.</p>
<ins data-rvad-zoneid="8" data-rvad-id="f837d8c96893e793fdbb230cffb628fc"></ins>

  </div>

  
 
<script>
  var navBarHTML = '\
<div>\
  <div class="container container-fluid">\
    <div class="navbar-header">\
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navBarCollapse" aria-expanded="false">\
        <span class="sr-only">Toggle navigation</span>\
        <span class="icon-bar"></span>\
        <span class="icon-bar"></span>\
        <span class="icon-bar"></span>\
      </button>\
      <a class="navbar-brand" href="https://www.OS-Q.com" title="OS-Q"></a>\
    </div>\
    <nav role="navigation" class="collapse navbar-collapse" id="navBarCollapse">\
      <div>\
        <ul class="nav navbar-nav">\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://stops.top" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cogs fa-lg"></i>STOPs<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://stops.top"><i class="fa fa-cogs"></i>官网主页</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/stops-top"><i class="fa fa-github"></i>开源社区</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://doc.stops.top"><i class="fa fa-book"></i>产品文档</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.SoC.xin" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-microchip fa-lg"></i>Xindex<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://www.SoC.xin/"><i class="fa fa-microchip"></i>芯片选型</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/socxin"><i class="fa fa-github"></i>开源社区</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://doc.SoC.xin"><i class="fa fa-book"></i>芯闻文档</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.zeergen.com" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cube fa-lg"></i>ZeerGen<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://www.zeergen.com"><i class="fa fa-home"></i>官网主页</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/zeergen"><i class="fa fa-github"></i>开源社区</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://doc.zeergen.com"><i class="fa fa-book"></i>说明文档</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.qitas.cn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-user fa-lg"></i>Qitas<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://www.qitas.cn"><i class="fa fa-mars"></i>个人主页</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/qitas"><i class="fa fa-github"></i>开源主页</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://docs.qitas.cn"><i class="fa fa-file"></i>知识分享</a></li>\
            </ul>\
          </li>\
        </ul>\
        <ul class="nav navbar-nav navbar-right">\
          <li class="active"><a href="https://www.os-q.com/qio"><i class="fa fa-book fa-lg"></i>QIO</a></li>\
          <li class="nav-soc-r"><a href="https://doc.OS-Q.com/pio"><i class="fa fa-book fa-lg"></i>PIO</a></li>\
          <li class="nav-soc-g"><a href="https://www.OS-Q.com"><i class="fa fa-quora fa-lg"></i>主页</a></li>\
          <li class="nav-soc-b"><a href="https://www.github.com/OS-Q"><i class="fa fa-github fa-lg"></i>开源</a></li>\
        </ul>\
      </div>\
    </nav>\
  </div>\
</div>';

  (function() {
    if (window.location.href.indexOf('http://') === 0) {
      location.href = 'https:' + window.location.href.substring(5);
    }

    var topBanner = $('.top-banner');
    var navBar = document.createElement('header');
    navBar.className = 'navbar navbar-inverse';
    navBar.innerHTML = navBarHTML;
    if (topBanner.length) {
      $(navBar).insertAfter(topBanner)
    } else {
      document.body.insertBefore(navBar, document.body.firstChild);
    }

    if ($(window).width() <= 768) {
      return;
    }

    var topOffset = 50;
    if (topBanner.length) {
      topOffset += $('.navbar').offset().top;
    }
    $('.wy-nav-side').css('top', topOffset + 'px');
    $(window).scroll(function() {
      $('.wy-nav-side').css('top', $(window).scrollTop() > topOffset ? 0 : topOffset + 'px');
    });
  })();
</script>
<!-- <ins data-rvad-zoneid="11" data-rvad-id="f837d8c96893e793fdbb230cffb628fc"></ins>
<script async src="https://ad.platformio.org/delivery/revasyncjs.dll"></script> -->


</footer>
        </div>

      </div>
    </section>
  </div>
  

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book">QIO Documentation</span> v0.1.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>OS-Q Created By Qtias</dt>
      <img src="./_static/images/weixin.jpg">
        <!-- <dd><a href="https://github.com/OS-Q/docs/blob/qio/source/framework/freertos.rst"> View</a></dd>
        <dd><a href="https://github.com/OS-Q/docs/edit/qio/source/framework/freertos.rst"> Edit</a></dd> -->
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1768265-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-1768265-7', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>